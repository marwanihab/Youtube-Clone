let appModule,createTestClient,ApolloServer,Models,connectDb,disconnectDb,resolver,expect,gql,token;_1af‍.w("../../modules/app",[["default",["appModule"],function(v){appModule=v}]]);_1af‍.w("apollo-server-testing",[["createTestClient",["createTestClient"],function(v){createTestClient=v}]]);_1af‍.w("apollo-server",[["ApolloServer",["ApolloServer"],function(v){ApolloServer=v}],["gql",["gql"],function(v){gql=v}]]);_1af‍.w("../db-testt",[["Models",["Models"],function(v){Models=v}],["connectDb",["connectDb"],function(v){connectDb=v}],["disconnectDb",["disconnectDb"],function(v){disconnectDb=v}]]);_1af‍.w("../../modules/user/resolvers",[["default",["resolver"],function(v){resolver=v}]]);_1af‍.w("chai",[["expect",["expect"],function(v){expect=v}]]);_1af‍.w("mocha");_1af‍.w("../user-resolvers-test.test",[["token",["token"],function(v){token=v}]]);









const server = new (_1af‍.a("ApolloServer",ApolloServer))({
    schema:  _1af‍.a("appModule",appModule).schema,
    context: () => ({ token: token })
    }) 

const { query, mutate } = _1af‍.a("createTestClient",createTestClient)(server)  
  
before(function (){
    _1af‍.a("connectDb",connectDb)()
})
after(function(){_1af‍.a("disconnectDb",disconnectDb)()})

describe('Running integration tests of the user', function() {
    //this.timeout()

    it('should login user', async() =>{
     const user = await _1af‍.a("Models",Models).user.create({username:'testUser1', password:'$2a$10$ypQA9dZhVtBHp99s.tMb5u2Kx6L8ZbvKUQjC.tmlzEQgyiA9hRwH.'})
     
     await user.save()

     const mutation = gql `
      mutation logIn{
        login(username: "testUser1", password:"M123456?m"){
          token
          username
        }
      }
     `
     const res = await mutate(
           {mutation : mutation}
         )
     _1af‍.a("expect",expect)(res.data.login.username).to.equal('testUser1')

     
    
    })
})
    